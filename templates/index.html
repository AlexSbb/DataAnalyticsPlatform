<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

     
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

<title>MAIT 2019</title>
  </head>
  <body>

<header class="navbar fixed-top navbar-dark bg-dark"> 
    <a class="navbar-brand" href="#">
        <img src="../img/logo.svg"  width="90" height="60" alt="">
    </a>
    <span class="navbar-brand mx-auto d-block text-center order-0 order-md-1 w-25">
       <h1 class="h1">Data Analytics Platform</h1> 
    </span>
</header>

<div class="modal fade" id="myModal">
    <div class="modal-dialog">
      <div class="modal-content">
      
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">Unfortunately something went wrong:</h4>
          <button type="button" class="close" data-dismiss="modal">Ã—</button>
        </div>
        
        <!-- Modal body -->
        <div class="modal-body" id="ModalBody">

        </div>
        
        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>
        
      </div>
    </div>
</div>





<div class="container-fluid">
    
    <div class="row">

        <nav class="col-md-3 d-none d-md-block bg-light sidebar" style="padding-top: 90px;"> 
            <div class="bd-toc-item sidebar-sticky">
                <h5 class="border-bottom"></h5>

                    <div class="input-group input-group-prepend">
                        
                            <label class="btn btn-secondary btn-file mb-3">
                                Import File<input type="file"  accept=".csv" id="ImportFile" style="display: none;"  onchange='onFilePicked(event)'>
                                <!-- <span class="glyphicon glyphicon-plus"></span> -->
                                <!-- <i class="glyphicon glyphicon-plus"></i> -->
                                <!-- <span aria-hidden="true">&plus;</span> -->
                            </label> 

                            <div class="dropdown mb-3 ml-1">
                                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                  Data Reset / Deletion
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                  <a class="dropdown-item" onclick="resetAll()">Reset All</a>
                                  <a class="dropdown-item" onclick="resetToOriginalData()">Reset to Original Data</a>
                                  <a class="dropdown-item" onclick="deleteSeries()">Delete selected series</a>
                                </div>
                            </div>
                        
                    </div>

                <h5 class="border-bottom">Select dataset</h5>

                        <div class="input-group">
                            <select class="custom-select" id="selectDataSet" onchange="onChangeselectDataSet()">
                                <option selected>Choose dataset:</option>
                                <!-- <option value="1">One</option> -->
                              </select>
                        </div><br>



                <h5 class="border-bottom">Outlier Recognition</h5>

                <ul class="nav flex-column">
                    <li class="nav-item">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="HardLimit_deviation" id="HardLimitRadios" value="option1" checked>
                            <label class="form-check-label" for="HardLimitRadios">
                                Hard limit values
                            </label>
                          </div>
                          <!-- MinMax -->
                          <div class="input-group input-group-sm mb-3 ml-1">
                            <div class="input-group-prepend">
                              <span class="input-group-text">Min</span>
                            </div>
                            <input type="number" class="form-control" id='Intrp_Min' step="0.0001" aria-label="Min Value" onKeyUp="this.reportValidity()">
                          </div>

                          <div class="input-group input-group-sm mb-3 ml-1">
                            <div class="input-group-prepend">
                              <span class="input-group-text">Max</span>
                            </div>
                            <input type="number" class="form-control" id='Intrp_Max' step="0.0001" aria-label="Max Value" onKeyUp="this.reportValidity()">
                          </div>
                          <!--  -->



                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="HardLimit_deviation" id="StdRadios" value="option2">
                            <label class="form-check-label" for="StdRadios">
                                Standart deviation
                            </label>
                          </div>

                         <!-- Standart deviation factor -->
                          <div class="input-group input-group-sm mb-3 ml-1">
                            <div class="input-group-prepend">
                              <span class="input-group-text">Std factor</span>
                            </div>
                            <input type="number" class="form-control" id='Std_factor' aria-label="Std factor" value="1" min="1" max="6" onKeyUp="this.reportValidity()">
                          </div>
                          <h5 class="border-bottom">Interpolation</h5>
                          <div class="form-check">
                            <input class="form-check-input mb-2" type="radio" name="Linear_quadratic" id="linear_radio" value="linear" checked>
                            <label class="form-check-label" for="linear_radio">
                                Linear Interpolation
                            </label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="Linear_quadratic" id="quadratic_radio" value="quadratic">
                            <label class="form-check-label mb-4" for="quadratic_radio">
                                Quadratic Interpolation
                            </label>
                          </div>
                          
                            <div class="text-center">
                                <button type="submit" class="btn btn-outline-secondary mb-3" onclick="performInterpolation()">Calculate</button>
                                <div class="alert alert-danger alert-dismissible fade show  mt-2" style="display:none;" id="alertInterpolation" role="alert">
                                    <label id="alertInterpolationLbl"></label> 
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                      <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                            </div>
                    </li >
                    <!-- <li class="nav-item">
                        <button  type="button" class="btn btn-light" data-toggle="modal" data-target="#MeanStandartdeviation"> Mean & Standart deviation </button>
                    </li > -->
                </ul>

                <!-- <h5 class="border-bottom"> Interpolation:</h5>
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <button  type="button" class="btn btn-light" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample" aria-pressed="true"> Linear Interpolation </button>

                        <div class="collapse ml-3 border-left" id="collapseExample">
                            <div class="input-group input-group-sm mb-3 ml-1">
                                <div class="input-group-prepend">
                                  <span class="input-group-text">Min</span>
                                </div>
                                <input type="text" class="form-control" id='Intrp_Min' aria-label="Min Value">
                              </div>

                              <div class="input-group input-group-sm mb-3 ml-1">
                                <div class="input-group-prepend">
                                  <span class="input-group-text">Max</span>
                                </div>
                                <input type="text" class="form-control" id='Intrp_Max' aria-label="Max Value">
                              </div>
                              
                              <div class="input-group input-group-sm mb-3 ml-1">
                                <div class="input-group-prepend">
                                    <button type="button" class="btn btn-secondary" onclick="buttonInterpolationClick()">Submit</button>
                                </div>
                              </div>
                        </div>
                    </li >
                    <li class="nav-item">
                        <button  type="button" class="btn btn-light"> Quadratic interpolation </button>
                    </li >
                </ul> -->
                <h5 class="border-bottom"> Smoothing</h5>
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="Smoothing" id="backward_radio" value="backward" checked>
                            <label class="form-check-label" for="backward_radio">
                                Backward
                            </label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="Smoothing" id="forward_radio" value="forward">
                            <label class="form-check-label" for="forward_radio">
                                Forward
                            </label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="Smoothing" id="fixed_radio" value="fixed">
                            <label class="form-check-label" for="fixed_radio">
                                Fixed
                            </label>
                          </div>
                          <div class="input-group input-group-sm mb-3 ml-1">
                            <div class="input-group-prepend">
                              <span class="input-group-text">Window</span>
                            </div>
                            <input type="number" class="form-control" id='Smooth_Window' aria-label="window" value="2" min="2" onKeyUp="this.reportValidity()">
                          </div>
                          <div class="text-center">
                            <button type="submit" class="btn btn-outline-secondary mb-3" onclick="performSmoothing()">Calculate</button>
                            <div class="alert alert-danger alert-dismissible fade show  mt-2" style="display:none;" id="alertSmoothing" role="alert">
                                <label id="alertSmoothingLbl"></label> 
                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                                </button>
                            </div>

                        </div>
                    </li >
                </ul>
                <h5 class="border-bottom"> I/O Relationship models:</h5>
                <ul class="nav flex-column">
                    <label>Select input:   </label>
                    <select class="custom-select mb-2" multiple size="4" id="selectDataSetNNInput" onchange="onChangeselectDataSet()">
                        <option selected>Choose one or more datasets:</option>
                        <!-- <option value="1">One</option> -->
                    </select>
                    <label>Select output:   </label>
                    <select class="custom-select mb-2" id="selectDataSetNNOutput" onchange="onChangeselectDataSet()">
                        <option selected>Choose one dataset:</option>
                        <!-- <option value="1">One</option> -->
                    </select>

                    <!-- Neural Network -->
                    <li class="nav-item"> 
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="NN_RF" id="neuralNet_radio" value="neuralNet" checked>
                            <label class="form-check-label mb-2" for="neuralNet_radio">
                                Neural Network
                            </label>
                        </div>
                        <!--Test Size  -->
                        <div class="input-group input-group-sm mb-3 ml-1">
                            <div class="input-group-prepend">
                              <span class="input-group-text">Test Size</span>
                            </div>
                            <input type="number" class="form-control" id='NN_testSize' aria-label="window" value="20.0" min="10" max="90" step="0.01" onKeyUp="this.reportValidity()">
                        </div>

                        <div class="input-group input-group-sm mb-3 ml-1">
                            <select class="custom-select " id="NN_activFunction" onchange="onChangeNN_activFunction()">
                                <option selected>Choose Active Function</option>
                                <option >Identity</option>
                                <option >Logistic</option>
                                <option >Tanh</option>
                                <option >Relu</option>
                              </select>
                        </div>

                        <div class="input-group input-group-sm mb-3 ml-1">
                            <select class="custom-select " id="NN_solverFunction" onchange="onChangeNN_solverFunction()">
                                <option selected>Choose Solver Function</option>
                                <option >Lbfgs</option>
                                <option >Sgd</option>
                                <option >Adam</option>
                              </select>
                        </div>



                        <!--Hidden layers  -->
                        <div class="input-group input-group-sm mb-3 ml-1">
                            <div class="input-group">
                                Hidden layers
                            </div>
                            <div class="input-group mb-1" id="inputPart1" style="font-size:small" >
                                <input type="number" class="mr-1" id="hl1" value="8" min="1" max="1000" onKeyUp="this.reportValidity();"/>
                                <input type="number" class="mr-1" id="hl2" value="4" min="1" max="1000" onKeyUp="this.reportValidity();"/>
                                <input type="number" class="mr-1" id="hl3" value="4" min="1" max="1000" onKeyUp="this.reportValidity();"/>
                                <input type="number" class="mr-1" id="hl4" value="" min="1" max="1000" onKeyUp="this.reportValidity();"/>
                                <input type="number" class="mr-1" id="hl5" value="" min="1" max="1000" onKeyUp="this.reportValidity();"/>
                            </div>
                            <div class="input-group mb-1 " id="inputPart2" style="font-size:small">
                                <input type="number" class="mr-1" id="hl6" value="" min="1" max="1000" onKeyUp="this.reportValidity();"/>
                                <input type="number" class="mr-1" id="hl7" value="" min="1" max="1000" onKeyUp="this.reportValidity();"/>
                                <input type="number" class="mr-1" id="hl8" value="" min="1" max="1000" onKeyUp="this.reportValidity();"/>
                                <input type="number" class="mr-1" id="hl9" value="" min="1" max="1000" onKeyUp="this.reportValidity();"/>
                                <input type="number" class="mr-1" id="hl10" value="" min="1" max="1000" onKeyUp="this.reportValidity();"/>
                            </div>   
                            <p>  </p>
                        <!--Iterations -->
                        <div class="input-group input-group-sm mb-3 mt-3 ml-1">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Iterations</span>
                            </div>
                            <input type="number" class="form-control" id='NN_iterations' aria-label="window" value="200" min="1" max="2000" onKeyUp="this.reportValidity();">
                        </div>


                        <div class="form-check ml-1">
                            <input class="form-check-input" type="checkbox" value="" id="NN_Scaling">
                            <label class="form-check-label" for="NN_Scaling">
                              Scaling
                            </label>
                        </div>
                        
                    </li >
                    <!-- Random Forest -->
                    <li class="nav-item">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="NN_RF" id="ranromF_radio" value="randomForest">
                            <label class="form-check-label mb-2" for="ranromF_radio">
                                Random Forest
                            </label>
                        </div>        
                        <!--Iterations -->
                        <div class="input-group input-group-sm mb-3 ml-1">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Trees</span>
                            </div>
                            <input type="number" class="form-control" id='RF_Trees' aria-label="Trees" value="300" min="1" max="1000" onKeyUp="this.reportValidity();" >    
                            <div class="input-group-prepend">
                                <span class="input-group-text">Test size</span>
                            </div>
                            <input type="number" class="form-control" id='RF_TestSize' aria-label="Test size" value="20"
                            min=10 max=90 step="0.01" onKeyUp="this.reportValidity();">
                        </div>
                        <div class="form-check ml-1">
                            <input class="form-check-input" type="checkbox" value="" id="RF_useHistory">
                            <label class="form-check-label" for="RF_useHistory">
                              Use history
                            </label>
                        </div>
                        <br>
                        <div class="text-center">
                            <button type="submit" class="btn btn-outline-secondary mb-5" onclick="calculateRelationshipModel()">Calculate</button>    
                            <div class="alert alert-danger alert-dismissible fade show  mt-2" style="display:none;" id="alertRelationshipModel" role="alert">
                                <label id="alertRelationshipModelLbl"></label> 
                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                                </button>
                            </div>                   
                        </div>
                    </li >
                </ul>
            </div>
        </nav>

        <main role="main" class="col-md-8 ml-sm-auto col-lg-9 px-4" style="padding-top: 90px;">

            <div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;">
                <div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;">
                    <div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div>
                </div>
                <div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;">
                <div style="position:absolute;width:200%;height:200%;left:0; top:0"></div>
                </div>
            </div>

            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-4 border-bottom">
                <h4 class="h4">Dashboard</h4>
            </div>
            <canvas id="myChart"  class="border-bottom"></canvas>
            <!-- <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea> -->
            <!-- Adding information below the chart -->
            <div class="jumbotron jumbotron-fluid mt-3 padding=0px">
                <div class="container" id="jumboContainer">
                    <!-- <h4 class="h4" id="titleInfoBox">Information about latest transaction</h4>  -->
                    <!-- adding a splitting line between information blocks -->
                    <!--<hr class="my-4"> -->
                    <!-- adding a subtitle -->
                    <!--<p class="lead">Outlier Recognition and Interpolation Information</p> -->
                    <!--<p class="lead">I/O Relationship Models</p> -->
                    <!--<label id="inputSeriesChosen">Input series chosen: n/a</label><br> -->
                </div>
            </div>


        </main>
    
    </div>
</div>

    

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js"></script>
<script src="https://unpkg.com/papaparse@latest/papaparse.min.js"></script>


<script>

    // Global var!!!!!!!!!!!!!!
    var dataSeriesDict ={}
    var ctx = document.getElementById('myChart').getContext('2d');
    var myChart
    var selectDataMenusArray = ["selectDataSet", "selectDataSetNNInput", "selectDataSetNNOutput"];
    var selectDataMenusArrayOptions = ["Choose dataset:", "Choose one or more datasets:", "Choose one dataset:"];

    //Get global data object from Python
    getGlobalDataObject() 

    // Import file, button action
    var onFilePicked = function(event) {
        var input = event.target;
        var file = input.files[0];
        console.log(file.name);
        ProcessFile(file);
        };
    
    // Process data from file
    function ProcessFile(file){
        Papa.parse(file, {
            config: {
                delimiter: ";",
                dynamicTyping: true,
                skipEmptyLines: true
            },
            complete: function(results) {
                console.log("Finished:", results.data);
                console.log("Arr:", results.data[0].length);
                
                //TO DO: ERROR CHECKING FOR FILE 

                // Rows to colums :( I  hate .csv
                correctResult =[]    //Array of vectors
                for (var index=0; index < results.data[0].length; ++index){
                    var column= []
                    for (var j in results.data){
                    column.push(parseFloat(results.data[j][index]));
                    };
                    correctResult.push(column)
                }
                console.log("correctResult:", correctResult);
                //formating the data to be sent to Python
                postData = { 
                    fileName: file.name.replace(".csv", ""),
                    dataArray: correctResult
                    };
                postDataToPython(postData)   // Go to send data to python
            }  
      
        });
    }
    //sending data to Python
    async function postDataToPython(postdata){
        const posturl = 'http://127.0.0.1:5000/importDataFromFile';
        try {
                const response = await fetch(posturl, {
                    method: 'POST', 
                    body: JSON.stringify(postdata), 
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                //waiting for the response from Python
                const json = await response.json();
                // console.log(json)
                dataSeriesDict = JSON.parse(json).dataSeriesDict;
                // console.log(dataSeriesDict)
                
                const keys = Object.keys(dataSeriesDict);
                console.log(keys);
                //prepares the information for the dropdown menu of the data series
                addOptionsToSelectDataset(keys)
                
                // console.log('Success:', JSON.stringify(json));
            } 
        catch (error) {

                console.error('Error:', error);
                $("#myModal").modal()
                document.getElementById("ModalBody").innerText = "Failure to upload file. Please make sure that you are uploading a valid csv file with values, separated by semi-colon."; 
            } 

    }   

    //method to receive the data from Python
    async function getGlobalDataObject() {
            const url = 'http://127.0.0.1:5000/getGlobalDataObject';
            const response = await fetch(url);
            const json = await response.json();           
            var message = JSON.parse(JSON.stringify(json));                          
                if (message.hasOwnProperty("message")){
                    console.log(json.message);
                    // alert(json.message);
                    $("#myModal").modal()
                    document.getElementById("ModalBody").innerText =message.message 
                    
                }
                else {
                    dataSeriesDict = JSON.parse(json).dataSeriesDict;
                    const keys = Object.keys(dataSeriesDict);
                    console.log(keys);
                    addOptionsToSelectDataset(keys)
                }

        };

    //removes all options from any dropdown menu
    function removeOptions(selectbox) {
        var i;
        for(i = selectbox.options.length - 1 ; i >= 0 ; i--)
        {
            selectbox.remove(i);
        }
    }
    //add options to a dropdown menu
    function addOptionsToSelectDataset(dataSetsNames) {
        
        for (i = 0; i < selectDataMenusArray.length; i++) {
            var selectDataSet = document.getElementById(selectDataMenusArray[i]);   
            removeOptions(selectDataSet)
            var option= document.createElement("option"); 
            option.textContent = selectDataMenusArrayOptions[i];
            selectDataSet.appendChild(option);
            dataSetsNames.forEach((element, index) => {
                var option= document.createElement("option"); 
                console.log(index); // 0, 1, 2
                option.textContent = element;
                selectDataSet.appendChild(option);
            });
        }
    };
    
    //action triggered when any selection is made in a dropdown menu
    function onChangeselectDataSet(){    
        var selectDataSet = document.getElementById("selectDataSet");
        currKey=selectDataSet.value
        console.log(currKey);
        console.log(dataSeriesDict[currKey].name);
        fillAllElements(currKey);
        plotData(currKey);
        emptyInfoDiv();
        updateSeriesInformation(currKey);
    };
    //make sure that there is no other info in the Info Box
    function emptyInfoDiv(){
        var div = document.getElementById("jumboContainer");
        while(div.firstChild){
            div.removeChild(div.firstChild);
        }
        var heading4 = document.createElement("h4");                 // Create a <p> element
        heading4.innerHTML = "Information about latest transaction";                // Insert text
        document.getElementById("jumboContainer").appendChild(heading4);     // Append <p> to <div> with id="myDIV"
        document.getElementById("jumboContainer").appendChild(document.createElement("br"));     // Create a <p> element
    };  
    //upon choosing a dataset, the side information block is updated
    function updateSeriesInformation(key){  
        var lbl1 = document.createElement("label");                 // Create a <label> element
        var lbl2 = document.createElement("label");                 // Create a <label> element
        var lbl3 = document.createElement("label");                 // Create a <label> element
        var lbl4 = document.createElement("label");                 // Create a <label> element
        var lbl5 = document.createElement("label");                 // Create a <label> element
        var lbl6 = document.createElement("label");                 // Create a <label> element
        var lbl7 = document.createElement("label");                 // Create a <label> element
        var lbl8 = document.createElement("label");                 // Create a <label> element

        var keysArray = ["name", "length", "realMin", "realMax", "size", "median", "meanSquareError", "accuracy"]

        lbl1.innerHTML = "Data series name: " + dataSeriesDict[key].name;                // Insert text
        document.getElementById("jumboContainer").appendChild(lbl1);     // Append <p> to <div> with id="myDIV" 
        document.getElementById("jumboContainer").appendChild(document.createElement("br"));     // Create an empty line
        lbl2.innerHTML = "Original length: " + dataSeriesDict[key].originalData.length;                // Insert text
        document.getElementById("jumboContainer").appendChild(lbl2);     // Append <p> to <div> with id="myDIV" 
        document.getElementById("jumboContainer").appendChild(document.createElement("br"));     // Create an empty line
        lbl3.innerHTML = "Minimum value: " + dataSeriesDict[key].realMin;                // Insert text
        document.getElementById("jumboContainer").appendChild(lbl3);     // Append <p> to <div> with id="myDIV" 
        document.getElementById("jumboContainer").appendChild(document.createElement("br"));     // Create an empty line
        lbl4.innerHTML = "Maximum value: " + dataSeriesDict[key].realMax;                // Insert text
        document.getElementById("jumboContainer").appendChild(lbl4);     // Append <p> to <div> with id="myDIV" 
        document.getElementById("jumboContainer").appendChild(document.createElement("br"));     // Create an empty line
        lbl5.innerHTML = "Median value: " + dataSeriesDict[key].median;                // Insert text
        document.getElementById("jumboContainer").appendChild(lbl5);     // Append <p> to <div> with id="myDIV" 
        document.getElementById("jumboContainer").appendChild(document.createElement("br"));     // Create an empty line
       
        if(dataSeriesDict[key].valPercent != ''){
            var lbl20 = document.createElement("label");
            lbl20.innerHTML = "Percentage of replaced: " + dataSeriesDict[key].valPercent;                // Insert text
            document.getElementById("jumboContainer").appendChild(lbl20);     // Append <p> to <div> with id="myDIV" 
            document.getElementById("jumboContainer").appendChild(document.createElement("br"));     // Create an empty line
        }
        
        if(dataSeriesDict[key].MeanSquareError != ''){
            var lbl21 = document.createElement("label");
            lbl21.innerHTML = "Mean Square Error: " + dataSeriesDict[key].MeanSquareError;                // Insert text
            document.getElementById("jumboContainer").appendChild(lbl21);     // Append <p> to <div> with id="myDIV" 
            document.getElementById("jumboContainer").appendChild(document.createElement("br"));     // Create an empty line

        }
        if(dataSeriesDict[key].Accuracy != ''){
            var lbl22 = document.createElement("label");
            lbl22.innerHTML = "Accuracy: " + dataSeriesDict[key].Accuracy;                // Insert text
            document.getElementById("jumboContainer").appendChild(lbl22);     // Append <p> to <div> with id="myDIV" 
            document.getElementById("jumboContainer").appendChild(document.createElement("br"));     // Create an empty line

        }
    };
    function fillAllElements(key){

        var HardLimitValuesMin = document.getElementById("Intrp_Min");
        var HardLimitValuesMax = document.getElementById("Intrp_Max");
        document.getElementById("Intrp_Min").setAttribute("min",dataSeriesDict[currKey].realMin); // set a new value;
        document.getElementById("Intrp_Min").setAttribute("max",dataSeriesDict[currKey].realMax); // set a new value;
        document.getElementById("Intrp_Max").setAttribute("min",dataSeriesDict[currKey].realMin); // set a new value;
        document.getElementById("Intrp_Max").setAttribute("max",dataSeriesDict[currKey].realMax); // set a new value;
        HardLimitValuesMin.value = dataSeriesDict[currKey].realMin;
        HardLimitValuesMax.value = dataSeriesDict[currKey].realMax;
        
        document.getElementById("Smooth_Window").setAttribute("max",dataSeriesDict[currKey].currentData.length); // set a new value;
    };

    function plotData(key){


        var chartColors = {
            red:    'rgb(255, 99, 132)',
            orange: 'rgb(255, 159, 64)',
            yellow: 'rgb(255, 205, 86)',
            green:  'rgb(75, 192, 192)',
            blue:   'rgb(54, 162, 235)',
            purple: 'rgb(153, 102, 255)',
            grey:   'rgb(201, 203, 207)'
        };
        var colorNames = Object.keys(chartColors);

        var currentData=dataSeriesDict[key].currentData;
        var originalData=dataSeriesDict[key].originalData;


        // var colorName = colorNames[config.data.datasets.length % colorNames.length];
        var colorName = colorNames[4];
        var newColor = chartColors[colorName];
        var config = {
            type: 'line',
            data: {
                labels: [...Array(currentData.length).keys()],
                datasets: [
                    {
                        label: 'currentData',
                        backgroundColor: newColor,
                        data: currentData,
                        borderColor: newColor,
                        fill: false
                    },
                    {
                        label: 'originalData',
                        backgroundColor: colorNames[3],
                        data: originalData,
                        borderColor: colorNames[3],
                        fill: false

                    }
            ]
            },
            options: {
                responsive: true,
                scaleShowGridLines : true,
                scaleShowVerticalLines: true,
                scaleShowHorizontalLines: true,
                maintainAspectRatio: true,
                scales: {
                    xAxes: [{
                        display: true,
                    }],
                    yAxes: [{
                        display: true,

                    }]
                }
		






                
            }
        };        
        
        var PredictedOutput=dataSeriesDict[key].PredictedOutput;
        var ExpectedOutput=dataSeriesDict[key].ExpectedOutput;
        if (PredictedOutput.length != []){
            addDataSet_1 = {
                label: 'PredictedOutput',
                backgroundColor: colorNames[5],
                data: PredictedOutput,
                borderColor: colorNames[5],
                fill: false
            }
            addDataSet_2 = {
                label: 'ExpectedOutput',
                backgroundColor: colorNames[6],
                data: ExpectedOutput,
                borderColor: colorNames[6],
                fill: false
            }
            config.data.datasets.push(addDataSet_1)
            config.data.datasets.push(addDataSet_2)

        }
 
        if (typeof myChart != "undefined") { 
                myChart.destroy();
                myChart = new Chart(ctx,config);
                // myChart.update();
            } else { 

                myChart = new Chart(ctx,config);

            } 
    }
    function valueWithinLimits(elementName){
        if (document.getElementById(elementName).value == "")
            return false;
        if (document.getElementById(elementName).reportValidity())
            return true;
        else return false;
    }
    function clearAlerts(){
    //    document.getElementById("alertInterpolation").style.display = "none";
    //    document.getElementById("alertSmoothing").style.display = "none";
    //    document.getElementById("alertRelationshipModel").style.display = "none";
    }
    function performInterpolation(){
        clearAlerts();
        var seriesName = document.getElementById("selectDataSet").value;
        var interpolationType; 
        var interpolationOutlierType; 

        console.log(seriesName);
        if (seriesName == "Choose dataset:"){
            document.getElementById("alertInterpolationLbl").textContent = "ALERT: Incomplete data. Please select the data series to apply this function to.";
            document.getElementById("alertInterpolation").style.display = "";
            //window.alert("The data provided is incomplete. Please select the data series to apply this function to.");
            return
        }
        if (document.getElementById("quadratic_radio").checked){
            // Quadratic
            interpolationType = 1;
        } else {
            // Linear
            interpolationType = 0;
        }
        if (document.getElementById("HardLimitRadios").checked){
            interpolationOutlierType = 'hardLimit'
        } else {
            interpolationOutlierType = 'std_dev'
        }
        if (!valueWithinLimits("Intrp_Min") && interpolationOutlierType == 'hardLimit'){
            document.getElementById("alertInterpolationLbl").textContent = "ALERT: Please select a valid minimum.";
            document.getElementById("alertInterpolation").style.display = "";
            //window.alert("The data provided is incomplete. Please select the data series to apply this function to.");
            return
        }
        if (!valueWithinLimits("Intrp_Max") && interpolationOutlierType == 'hardLimit'){
            document.getElementById("alertInterpolationLbl").textContent = "ALERT: Please select a valid maximum.";
            document.getElementById("alertInterpolation").style.display = "";
            //window.alert("The data provided is incomplete. Please select the data series to apply this function to.");
            return
        }
        if ( !valueWithinLimits("Std_factor") && interpolationOutlierType == 'std_dev'){
            document.getElementById("alertInterpolationLbl").textContent = "ALERT: Please select a valid standard deviation factor.";
            document.getElementById("alertInterpolation").style.display = "";
            //window.alert("The data provided is incomplete. Please select the data series to apply this function to.");
            return
        }
        if (interpolationOutlierType == 'hardLimit'){
            postData = { 
                action: "performInterpolationHardLimits",
                seriesName: seriesName,
                interpolationType: interpolationType, //linear or quadratic
                selectedMin: document.getElementById("Intrp_Min").value,
                selectedMax: document.getElementById("Intrp_Max").value
            }; 
        } else {
            postData = { 
                action: "performInterpolationStdDev",
                seriesName: seriesName,
                interpolationType: interpolationType, //linear or quadratic
                Std_factor: document.getElementById("Std_factor").value
            };
        }
        postActionToPython(postData)   // Go to send data to python  
    }
    // performing smoothing - we check if there is a type selected and also data and inform the customer 
    function performSmoothing(){
        clearAlerts();
        if (!valueWithinLimits("Smooth_Window")) {
            document.getElementById("alertSmoothingLbl").textContent = "ALERT: The number provided for window size is inaccurate. Please fill enter a value greater or equal to 2 and less than the size of the data series.";
            document.getElementById("alertSmoothing").style.display = "";
            // window.alert("The number provided for window size is inaccurate. Please fill enter a value greater or equal to 2 and less than the size of the data series.");
            return
        }
        var seriesName = document.getElementById("selectDataSet").value
        if (seriesName == "Choose dataset:"){
            document.getElementById("alertSmoothingLbl").textContent = "ALERT: The data provided is incomplete. Please select the data series to apply this function to.";
            document.getElementById("alertSmoothing").style.display = "";
            //window.alert("The data provided is incomplete. Please select the data series to apply this function to.");
            return
        }
        var smoothingType = ""
        if(document.getElementById("backward_radio").checked){
            smoothingType = document.getElementById("backward_radio").value;
        } else if (document.getElementById("forward_radio").checked) {
            smoothingType = document.getElementById("forward_radio").value;
        } else if (document.getElementById("fixed_radio").checked){
            smoothingType = document.getElementById("fixed_radio").value;
        } else {
            document.getElementById("alertSmoothingLbl").textContent = "ALERT: The data provided is incomplete. Please fill in all relevant information and try again.";
            document.getElementById("alertSmoothing").style.display = "";
            // window.alert("The data provided is incomplete. Please fill in all relevant information and try again.");
            return;
        }
        postData = { 
                action: "performSmoothing",
                seriesName: seriesName,
                smoothingType: smoothingType,
                window: document.getElementById("Smooth_Window").value
        };
        postActionToPython(postData)   // Go to send data to python  
    }

    function calculateRelationshipModel(){
        clearAlerts();
        var inputSeriesNameArray = Array.from(document.getElementById("selectDataSetNNInput").options).filter(option => option.selected).map(option => option.value);
        if (inputSeriesNameArray.includes("Choose one or more datasets:") && inputSeriesNameArray.length() == 1){
            document.getElementById("alertRelationshipModelLbl").textContent = "ALERT: Please select at least one input data series.";
            document.getElementById("alertRelationshipModel").style.display = "";
            return
        }
        var outputSeriesName = document.getElementById("selectDataSetNNOutput").value;
        if (outputSeriesName == "Choose one dataset:"){
            document.getElementById("alertRelationshipModelLbl").textContent = "ALERT: Please select an output data series.";
            document.getElementById("alertRelationshipModel").style.display = "";
            return;
        }
        var modelType;
        if(document.getElementById("neuralNet_radio").checked){
            modelType = "Neural Network";
        } else {
            modelType = "Random Forest";
        }
        if (modelType == "Neural Network"){
            if (!valueWithinLimits("NN_testSize")) {
                document.getElementById("alertRelationshipModelLbl").textContent = "ALERT: Invalid number provided for the test size.";
                document.getElementById("alertRelationshipModel").style.display = "";
                // window.alert("The number provided for window size is inaccurate. Please fill enter a value greater or equal to 2 and less than the size of the data series.");
                return
            }  
            var activeFunction = document.getElementById("NN_activFunction").value;
            if (activeFunction == "Choose Active Function"){
                document.getElementById("alertRelationshipModelLbl").textContent = "ALERT: Please select an active function.";
                document.getElementById("alertRelationshipModel").style.display = "";
                //window.alert("The data provided is incomplete. Please select the data series to apply this function to.");
                return;
            }
            var solverFunction = document.getElementById("NN_solverFunction").value;
            if (solverFunction == "Choose Solver Function"){
                document.getElementById("alertRelationshipModelLbl").textContent = "ALERT: Please select a solver function.";
                document.getElementById("alertRelationshipModel").style.display = "";
                //window.alert("The data provided is incomplete. Please select the data series to apply this function to.");
                return;
            }
            var numberOfInputsForHiddenLayers = 10;
            var arrayWithHiddenLayerInfo = [];
            for (i = 1; i <= numberOfInputsForHiddenLayers; i++) {
                var inputName = "hl" + i;
                console.log(inputName)
                if (document.getElementById(inputName).value == ""){
                } else {
                    if (!valueWithinLimits(inputName)) {
                        document.getElementById("alertRelationshipModelLbl").textContent = "ALERT: Please select valid hidden layer values.";
                        document.getElementById("alertRelationshipModel").style.display = "";
                        return;
                    } else {
                        arrayWithHiddenLayerInfo.push(document.getElementById(inputName).value);
                    }
                }
            }
            console.log(arrayWithHiddenLayerInfo);
            if(arrayWithHiddenLayerInfo.length == 0){
                document.getElementById("alertRelationshipModelLbl").textContent = "ALERT: Please select valid hidden layer values.";
                document.getElementById("alertRelationshipModel").style.display = "";
                return;
            }
           if (!valueWithinLimits("NN_iterations")) {
                document.getElementById("alertRelationshipModelLbl").textContent = "ALERT: Invalid number of iterations provided.";
                document.getElementById("alertRelationshipModel").style.display = "";
                // window.alert("The number provided for window size is inaccurate. Please fill enter a value greater or equal to 2 and less than the size of the data series.");
                return
            }  
            postData = { 
                action: "performNNCalculations",
                inputSeries: inputSeriesNameArray,
                outputSeries: outputSeriesName,
                testSize: document.getElementById("NN_testSize").value,
                activeFunction: activeFunction,
                solverFunction: solverFunction,
                hiddenLayers: arrayWithHiddenLayerInfo,
                iterations: document.getElementById("NN_iterations").value,
                scalingOnOff: document.getElementById("NN_Scaling").value
            };
           postActionToPython(postData)   // Go to send data to python  
        } else if (modelType == "Random Forest"){
            if (!valueWithinLimits("RF_Trees")) {
                document.getElementById("alertRelationshipModelLbl").textContent = "ALERT: Invalid number of trees provided.";
                document.getElementById("alertRelationshipModel").style.display = "";
                // window.alert("The number provided for window size is inaccurate. Please fill enter a value greater or equal to 2 and less than the size of the data series.");
                return
            }  
            if (!valueWithinLimits("RF_TestSize")) {
                document.getElementById("alertRelationshipModelLbl").textContent = "ALERT: Invalid test size provided.";
                document.getElementById("alertRelationshipModel").style.display = "";
                // window.alert("The number provided for window size is inaccurate. Please fill enter a value greater or equal to 2 and less than the size of the data series.");
                return
            }  
            postData = { 
                action: "performRFCalculations",
                inputSeries: inputSeriesNameArray,
                outputSeries: outputSeriesName,
                trees: document.getElementById("RF_Trees").value,
                testSize: document.getElementById("RF_TestSize").value,
                historyOnOff: document.getElementById("RF_useHistory").value
            };
            postActionToPython(postData)   // Go to send data to python  
        } 
    }

    //Alex, sorry that I am overwriting your method
    function buttonInterpolationClick(){
        //true for HardLimit and false for standart deviation
        //true for linear and false for quadratic interpolation
        
        seriesName = document.getElementById("selectDataSet").value
        if (seriesName == "Choose dataset:"){
            return
        }
        else{
            postData = {   
                seriesName: seriesName,       
                limit_or_dev: document.getElementById("HardLimitRadios").checked, 
                selectedMin: document.getElementById("Intrp_Min").value,
                selectedMax: document.getElementById("Intrp_Max").value,
                stdDevFactor: document.getElementById("Std_factor").value,
                interpolationType: document.getElementById("linear_radio").checked
            };  
            console.log(postData)  
            postCaclulateInterpolation(postData)   
        }




        


    };

    function resetAll(){
        postData = { 
            action: "deleteAll"
        };
        postActionToPython(postData)   // Go to send data to python
    }
    function resetToOriginalData(){
        postData = { 
            action: "resetToOriginalData"
        };
        postActionToPython(postData)   // Go to send data to python
    }

    function deleteSeries(){
        seriesName = document.getElementById("selectDataSet").value
        if (seriesName == "Choose dataset:"){
            return
        }
        postData = { 
            seriesName: seriesName,
            action: "deleteSeries"
        };
        postActionToPython(postData)   // Go to send data to python
    }

    async function postActionToPython(postdata){
        const posturl = 'http://127.0.0.1:5000/dataManipulation';
        try {
                const response = await fetch(posturl, {
                    method: 'POST', 
                    body: JSON.stringify(postdata), 
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                //waiting for the response from Python
                const json = await response.json();

                var message = JSON.parse(JSON.stringify(json));                          
                if (message.hasOwnProperty("message")){
                    console.log(json.message);
                    // alert(json.message);
                    $("#myModal").modal()
                    document.getElementById("ModalBody").innerText =message.message;
                }
                else {

                    
                    
                    if (postdata.action == "deleteSeries" || postdata.action =="resetToOriginalData" || postdata.action == "deleteAll"){
                        location.reload();
                    }
                    else{

                        dataSeriesDict = JSON.parse(json).dataSeriesDict;
                        const keys = Object.keys(dataSeriesDict);
                        console.log(keys);
                        //prepares the information for the dropdown menu of the data series
                        addOptionsToSelectDataset(keys);
                        document.getElementById("selectDataSet").value=postdata.seriesName
                        onChangeselectDataSet()   

                        
                    }                   

                }
                



            } 
        catch (error) {
                console.error('Error:', error);
            } 
    }

    // async function postCaclulateInterpolation(postdata){
    //     const posturl = 'http://127.0.0.1:5000/interpolation';
    //     try {
    //             const response = await fetch(posturl, {
    //                 method: 'POST', 
    //                 body: JSON.stringify(postdata), 
    //                 headers: {
    //                     'Content-Type': 'application/json'
    //                 }
    //             });
    //             //waiting for the response from Python
    //             const json = await response.json();
    //             console.log(json)
    //             //dataSeriesDict = JSON.parse(json).dataSeriesDict;
    //             // console.log(dataSeriesDict)
  
    //         } 
    //     catch (error) {
    //             console.error('Error:', error);
    //         } 
    // }      

</script>

  </body>
</html>